<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced.
     An alternate method (rfc include) is described in the references. -->
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC6241 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6241.xml">
<!ENTITY RFC7950 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.7950.xml">
<!ENTITY RFC7149 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.7149.xml">
<!ENTITY RFC7426 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.7426.xml">
<!ENTITY RFC8299 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8299.xml">
<!ENTITY RFC8309 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8309.xml">
<!ENTITY RFC8340 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8340.xml">
<!ENTITY RFC8453 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8453.xml">
<!ENTITY RFC8174 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC8345 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8345.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs),
     please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="std" docName="draft-ietf-opsawg-sap-latest" ipr="trust200902">
  <front>
    <title abbrev="Network YANG for SAPs">A Network YANG Model for Service
    Attachment Points (SAPs)</title>

    <author fullname="Mohamed Boucadair" initials="M." role="editor"
            surname="Boucadair">
      <organization>Orange</organization>

      <address>
        <postal>
          <street></street>

          <city></city>

          <region></region>

          <code></code>

          <country>France</country>
        </postal>

        <phone></phone>

        <email>mohamed.boucadair@orange.com</email>
      </address>
    </author>

    <author fullname="Oscar Gonzalez de Dios" initials="O"
            surname="Gonzalez de Dios">
      <organization>Telefonica</organization>

      <address>
        <postal>
          <street></street>

          <city>Madrid</city>

          <region></region>

          <code></code>

          <country>Spain</country>
        </postal>

        <phone></phone>

        <email>oscar.gonzalezdedios@telefonica.com</email>
      </address>
    </author>

    <author fullname="Samier Barguil" initials="S." surname="Barguil">
      <organization>Telefonica</organization>

      <address>
        <postal>
          <street></street>

          <city>Madrid</city>

          <region></region>

          <code></code>

          <country>Spain</country>
        </postal>

        <phone></phone>

        <facsimile></facsimile>

        <email>samier.barguilgiraldo.ext@telefonica.com</email>

        <uri></uri>
      </address>
    </author>

    <author fullname="Qin Wu" initials="Q." surname="Wu">
      <organization>Huawei</organization>

      <address>
        <postal>
          <street>101 Software Avenue, Yuhua District</street>

          <city>Nanjing</city>

          <region>Jiangsu</region>

          <code>210012</code>

          <country>China</country>
        </postal>

        <email>bill.wu@huawei.com</email>
      </address>
    </author>

    <author fullname="Victor Lopez" initials="V." surname="Lopez">
      <organization>Nokia</organization>

      <address>
        <postal>
          <street></street>

          <city></city>

          <region></region>

          <code></code>

          <country>Spain</country>
        </postal>

        <phone></phone>

        <facsimile></facsimile>

        <email>victor.lopez@nokia.com</email>

        <uri></uri>
      </address>
    </author>

    <date year="2022" />

    <area>ops</area>

    <workgroup>OPSAWG</workgroup>

    <keyword>SAP Network YANG</keyword>

    <abstract>
      <t>This document defines a YANG data model for representing an abstract
      view of the provider network topology that contains the points from
      which its services can be attached (e.g., basic connectivity, VPN,
      network slices). Also, the model can be used to retrieve the points
      where the services are actually being delivered to customers (including
      peer networks).</t>

      <t>The data model augments the 'ietf-network' data model by adding the
      concept of Service Attachment Points (SAPs). The Service Attachment
      Points are the network reference points to which network services, such
      as Layer 3 Virtual Private Network (L3VPN) or Layer 2 Virtual Private
      Network (L2VPN), can be attached. Both User-Network Interface (UNI) and
      Network-to-Network Interface (NNI) SAPs are supported in the data
      model.</t>
    </abstract>
  </front>

  <middle>
    <section anchor="Introduction" title="Introduction">
      <t>From the perspective of a service provider, the Service Attachment
      Points (SAPs) are abstraction of the network reference points where
      network services can be attached. The SAP is an important architectural
      concept in many implementations and deployments of services, such as
      Virtual Private Networks (VPNs), Software-Defined Wide Area Network
      (SDWAN) <xref target="I-D.ietf-bess-bgp-sdwan-usage"></xref>, or network
      slices <xref target="I-D.ietf-teas-ietf-network-slices"></xref>. For
      example, it is used to decide where to attach and, thus, deliver the
      service in the Layer 3 VPN Service Model (L3SM) <xref
      target="RFC8299"></xref> and the Layer 2 VPN Service Model (L2SM) <xref
      target="RFC8466"></xref>. It can also be used to retrieve where
      services, such as the Layer 3 VPN Network Model (L3NM) <xref
      target="I-D.ietf-opsawg-l3sm-l3nm"></xref>, and the Layer 2 VPN Network
      Model (L2NM) <xref target="I-D.ietf-opsawg-l2nm"></xref>, are delivered
      to customers.</t>

      <t>This document defines a YANG network model (<xref
      target="mod"></xref>) for representing, managing, and controlling the
      Service Attachment Points. The data model augments the 'ietf-network'
      module <xref target="RFC8345"></xref> by adding the concept of Service
      Attachment Points. This document explains the scope and purpose of a SAP
      network model and its relation with other models (<xref
      target="rel"></xref>). </t>

      <t>Multiple service types can be associated with a given network.
      Whether a SAP is dedicated to a specific service or shared among many
      services is deployment specific. This document supports both deployment
      schemes.</t>

      <t>This document does not make any assumption about the service(s)
      provided by a network to its users. VPN services (e.g., Layer 3 Virtual
      Private Network (L3VPN) or Layer 2 Virtual Private Network (L2VPN)) are
      used for illustration purposes (Appendices <xref format="counter"
      target="app1"></xref> and <xref format="counter"
      target="sample"></xref>).</t>

      <t>Both User-Network Interface (UNI) and Network-to-Network Interface
      (NNI) SAPs are supported in the document. An example is provided in
      <xref target="nniapp"></xref>.</t>

      <t>The YANG data model in <xref target="mod"></xref> conforms to the
      Network Management Datastore Architecture (NMDA) <xref
      target="RFC8342"></xref>.</t>
    </section>

    <section anchor="terminology" title="Terminology">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in BCP 14
      <xref target="RFC2119"></xref><xref target="RFC8174"></xref> when, and
      only when, they appear in all capitals, as shown here.</t>

      <t>This document assumes that the reader is familiar with the contents
      of <xref target="RFC6241"></xref>, <xref target="RFC7950"></xref>, <xref
      target="RFC8345"></xref>, and <xref target="RFC8309"></xref>. The
      document uses terms from those documents.</t>

      <t>The meanings of the symbols in tree diagrams are defined in <xref
      target="RFC8340"></xref>.</t>

      <t>This document uses the term "network model" defined in Section 2.1 of
      <xref target="RFC8969"></xref>.</t>

      <t>This document uses the following terms:<list style="hanging">
          <t hangText="Service povider: ">The organization responsible for
          operating the network that offers a service (e.g., a VPN) to
          customers.</t>

          <t hangText="Customer Edge (CE): ">An equipment that is dedicated to
          a particular customer and is directly connected to one or more
          Provider Edges (PEs) via attachment circuits (ACs). A CE is usually
          located at the customer premises. A CE may be dedicated to a single
          service (e.g., L3VPN), although it may support multiple VPNs if each
          one has separate attachment circuits. A CE can be a router, bridge,
          switch, etc.</t>

          <t hangText="Provider Edge (PE): ">An equipment owned and managed by
          the service provider that can support multiple services (e.g., VPNs)
          for different customers. A PE is directly connected to one or more
          CEs via ACs.</t>

          <t hangText="Service Attachment Point (SAP):  ">Describes the
          service's endpoint characteristics and its reference to a
          Termination Point (TP) of a PE.</t>
        </list></t>
    </section>

    <section anchor="usage" title="SAP Network Model Usage">
      <t>Management operations of a service provider network can be automated
      using a variety of means such as interfaces based on YANG modules <xref
      target="RFC8969"></xref>. From that standpoint, and considering the
      architecture depicted in <xref target="fi1"></xref>, a goal of this
      document is to provide a mechanism to show via a YANG-based interface an
      abstracted network view from the network controller to the service
      orchestration layer with a focus on where a service can be delivered to
      customers. The model is also used to retrieve the network points where a
      service is being delivered to customers. For services that require
      resources from peer networks, the module can also be used to expose
      NNIs. </t>

      <figure align="center" anchor="fi1" title="SAP Network Model Usage">
        <artwork align="left"><![CDATA[                            +-----------------+
                            |     Customer    |
                            +--------+--------+
            Customer Service Models  |
               (e.g., L3SM, L2SM)    |
                            +--------+--------+
                            |    Service      |
                            |  Orchestration  |
                            +------+---+------+
                Network Models     |   | SAP Network Model
              (e.g., L3NM, L2NM)   |   |
                            +------+---+------+
                            |     Network     |
                            |   Controller    |
                            +--------+--------+
                                     |
               +---------------------+---------------------+
               |                  Network                  |
               +-------------------------------------------+
]]></artwork>
      </figure>

      <t>Let us consider the example of a typical service provider network
      (<xref target="fi2"></xref>), with PE and P nodes.</t>

      <t><figure align="center" anchor="fi2" title="Sample Network Topology">
          <artwork align="center"><![CDATA[.---------.          .---------.
|   PE1   |          |   PE2   |
'---------'          '---------'
           \        /
            .------.
            | P(s) |
            '------'
          /         \
.---------.          .---------.
|   PE3   |          |   PE4   |
'---------'          '---------']]></artwork>
        </figure></t>

      <t>The service orchestration layer does not need to know about the
      internals of the underlying network (e.g., P nodes). <xref
      target="fi2a"></xref> shows the abstract network view as seen by a
      service orchestrator. However, this view is not enough to provide to the
      service orchestration layer the information to create services in the
      network. The service topology need is to be able to expose the set of
      nodes and the attachment points associated with the nodes from which
      network services can be grafted (delivered).</t>

      <t><figure align="center" anchor="fi2a"
          title="Abstract Network Topology">
          <artwork align="center"><![CDATA[.---------.          .---------.
|   PE1   |          |   PE2   |
'---------'          '---------'
                                         

.---------.          .---------.
|   PE3   |          |   PE4   |
'---------'          '---------']]></artwork>
        </figure></t>

      <t>Typically, and focusing on the UNIs, the service orchestration layer
      would see a set of PEs and a set of client-facing interfaces (physical
      or logical) to which CEs can be connected (or are actually connected).
      The service orchestration layer can use these interfaces to setup the
      requested services or to commit the delivery of a service. <xref
      target="fi3"></xref> depicts a sample SAP network topology that is
      maintained by the network controller and exposed to the service
      orchestration.</t>

      <figure align="center" anchor="fi3" title="SAP Network Topology">
        <artwork align="center"><![CDATA[           .-+-. .-+-. .-+-.              .-+-.       .-+-.   
         .-|sap|-|sap|-|sap|-.          .-|sap|-------|sap|-. 
         | '---' '---' '---' |          | '---'       '---' |
       .---.                 |          |                   |
       |sap|      PE1        |          |         PE2       |
       '---'                 |          |                   |
         |                   |          |                   |
         '-------------------'          '-------------------'
                                                   
                                                   
         .-------------------.          .-------------------.
         |                   |          |                   |
         |                   |          |                 .---.
         |         PE3       |          |        PE4      |sap|
         |                   |          |                 '---'
         | .---. .---. .---. |          | .---. .---. .---. |  
         '-|sap|-|sap|-|sap|-'          '-|sap|-|sap|-|sap|-'  
           '-+-' '-+-' '-+-'              '-+-' '-+-' '-+-'       
]]></artwork>
      </figure>

      <t>A single SAP network topology can be used for one or multiple service
      types (e.g., L3VPN, Ethernet VPN (EVPN)). The network controller can,
      then, expose the service type(s) and associated interfaces via the
      SAPs.</t>

      <t>As shown in <xref target="fi3a"></xref>, the service orchestration
      layer will have also access to a set of customer service model (e.g.,
      the L3SM or the L2SM) in the customer-facing interface and a set of
      network models (e.g., the L3NM and network topology data models) in the
      resource-facing interface. In this use case, it is assumed that the
      network controller is unaware of what happens beyond the PEs towards the
      CEs; it is only responsible for the management and control of the SAPs
      and the network between PEs. In order to correlate between delivery
      points expressed in service requests and SAPs, the SAP model may include
      a peer customer point identifier. That identifier can be a CE
      identifier, a site identifier, etc.</t>

      <t><figure align="center" anchor="fi3a"
          title="Network Topology with CEs and ACs">
          <artwork align="center"><![CDATA[                                                      .---.
                                                      |CE2|
                                                      '-+-'
                                                        | 
           .-+-. .-+-. .-+-.              .-+-.       .-+-.   
         .-|sap|-|sap|-|sap|-.          .-|sap|-------|sap|-. 
         | '---' '---' '---' |          | '---'       '---' |
.---.  .---.                 |          |                   |
|CE1+--+sap|      PE1        |          |         PE2       |
'---'  '---'                 |          |                   |
         |                   |          |                   |
         '-------------------'          '-------------------'
                                                   
                                                   
         .-------------------.          .-------------------.
         |                   |          |                   |
         |                   |          |                 .---.  .---.
         |         PE3       |          |        PE4      |sap+--+CE5|
         |                   |          |                 '---'  '---'
         | .---. .---. .---. |          | .---. .---. .---. |  
         '-|sap|-|sap|-|sap|-'          '-|sap|-|sap|-|sap|-'   
           '-+-' '-+-' '-+-'              '-+-' '-+-' '-+-'   
                         |                        | 
                       .-+-.                    .-+-.
                       |CE3|                    |CE4|
                       '-+-'                    '-+-'   
]]></artwork>
        </figure></t>

      <t>Refer to <xref target="app1"></xref> for an example echoing the
      topology depicted in <xref target="fi3a"></xref>.</t>
    </section>

    <section anchor="rel" title="Relationship to Other YANG Data Models">
      <t>The SAP network model can be seen as an inventory data associated
      with SAPs. The model maintains an inventory of nodes contained in a
      network relying upon <xref target="RFC8345"></xref>.</t>

      <figure anchor="fig5"
              title="Relation of SAP Network Model to Other Models">
        <artwork><![CDATA[                +-------------------------+
                |                         |
                |  Abstract Network Model |
                |                         |
                +------------+------------+
                             |
                   +---------+---------+
                   |                   |
            +------V------+     +------V------+
            |  Abstract   |     |  Inventory  |
            |  Network    |     |   Model(s)  |
            |  Topology   |     |   e.g., SAP |
            |   Model     |     |   Network   |
            |             |     |    Model    |
            +-----+-------+     +-------------+
                  |
      +-----------+-----------+
      |           |           |
 +----V----+ +----V----+ +----V----+
 |TE Topo  | |L3 Topo  | |L2 Topo  |
 |  Model  | |  Model  | |  Model  | ...
 +---------+ +---------+ +---------+]]></artwork>
      </figure>

      <t><xref target="fig5"></xref> depicts the relationship of the SAP
      network model to other models. The SAP network model augments from the
      Network model <xref target="RFC8345"></xref> and imports Network
      Topology model, while other technology-specific topology models (e.g.,
      TE Topologies model <xref target="RFC8795"></xref> or L3 Topology model
      <xref target="RFC8346"></xref>) augment from the Network Topology.</t>

      <t>In the context of Software-Defined Networking (SDN) <xref
      target="RFC7149"></xref><xref target="RFC7426"></xref>, the SAP YANG
      data model can be used to exchange information between control elements,
      so as to support VPN service provision and resource management discussed
      in <xref target="I-D.ietf-opsawg-l3sm-l3nm"></xref><xref
      target="I-D.ietf-opsawg-l2nm"></xref>. Through this data model, the
      service orchestration layer can learn the available endpoints (i.e.,
      SAPs) of interconnection resources of the underlying network. The
      service orchestration layer can determine which interconnection
      endpoints to add to an L2VPN or L3VPN service. With the help of other
      data models (e.g., L3SM <xref target="RFC8299"></xref> or L2SM <xref
      target="RFC8466"></xref>), hierarchical control elements can also assess
      the feasibility of an end-to-end IP connectivity or L2VPN connectivity
      and, therefore, derive the sequence of domains and the points of
      interconnection to use.</t>
    </section>

    <section anchor="tree" title="SAP Module Tree Structure">
      <t>The SAP network model builds on the network data model defined in the
      'ietf-network' module <xref target="RFC8345"></xref>, augmenting the
      nodes with Service Attachment Points, which anchor the links and are
      contained in nodes. The 'service-attachment-point' attribute defined in
      the SAP network model is not a tunnel termination point (TTP) nor a
      link, but an abstraction of the termination point defined in <xref
      target="RFC8345"></xref>.</t>

      <t>The structure of the 'ietf-sap-ntw' module is shown in <xref
      target="fi4"></xref>.</t>

      <figure anchor="fi4" title="SAP YANG Module Tree Structure">
        <artwork><![CDATA[module: ietf-sap-ntw
  augment /nw:networks/nw:network/nw:network-types:
    +--rw sap-network!
       +--rw sap-type*   identityref
  augment /nw:networks/nw:network/nw:node:
    +--rw service* [sap-type]
       +--rw sap-type                    identityref
       +--rw service-attachment-point* [attachment-id]
          +--rw attachment-id               string
          +--rw description?                string
          +--rw attachment-interface?       string
          +--rw parent-termination-point?   nt:tp-id
          +--rw interface-type?             identityref
          +--rw encapsulation-type?         identityref
          +--rw interface-role?             identityref
          +--rw peer-customer-sap-id?       string
          +--ro sap-status
          |  +--ro status?        identityref
          |  +--ro last-change?   yang:date-and-time
          +--ro service-status
             +--ro status?        identityref
             +--ro last-change?   yang:date-and-time]]></artwork>
      </figure>

      <t></t>

      <t>A SAP network topology can be used for one or multiple service types
      ('sap-type'). When a SAP topology is used for many service types, the
      underlying (network) nodes must support at least one of these service
      types. Examples of supported service types are as follows:<list
          style="symbols">
          <t>L3VPN <xref target="RFC4364"></xref>,</t>

          <t>Virtual Private LAN Service (VPLS) using BGP <xref
          target="RFC4761"></xref>,</t>

          <t><xref target="RFC4762">VPLS using Label Distribution Protocol
          (LDP)</xref>,</t>

          <t><xref target="RFC8214">Virtual Private Wire Service
          (VPWS)</xref>,</t>

          <t><xref target="RFC7432">BGP MPLS-Based Ethernet VPN</xref>,</t>

          <t><xref target="RFC8365">Ethernet VPN (EVPN)</xref>,</t>

          <t><xref target="RFC7623">Provider Backbone Bridging Combined with
          Ethernet VPN (PBB-EVPN)</xref>,</t>

          <t>Virtual Networks <xref target="RFC8453"></xref>,</t>

          <t>Enhanced VPN (VPN+) <xref
          target="I-D.ietf-teas-enhanced-vpn"></xref>,</t>

          <t>Network slice <xref
          target="I-D.ietf-teas-ietf-network-slices"></xref>,</t>

          <t>SDWAN <xref target="I-D.ietf-bess-bgp-sdwan-usage"></xref>,
          and</t>

          <t>Basic IP connectivity.</t>
        </list></t>

      <t>Additional service types can be defined in future YANG modules, if
      needed.</t>

      <t>A node in the topology can support one or multiple service types
      ('sap-type'). A list of SAPs are then bound to each service type. Each
      SAP is characterized as follows:<list style="hanging">
          <t hangText="'attachment-id':">Includes an identifier that uniquely
          identifies a SAP within a node. The same identifier can be reused in
          other nodes.<vspace blankLines="1" />'attachment-id' may include a
          reference to a physical or a logical interface. For example,
          'attachment-id' may be the interface identifier of a VPN network
          access used in Section 7.6 of <xref
          target="I-D.ietf-opsawg-l3sm-l3nm"></xref>. <vspace
          blankLines="1" />SAPs that are associated with the interfaces that
          are directly hosting services, interfaces that are ready to host
          per-service sub-interfaces, and already instantiated on
          sub-interfaces are listed as SAPs. </t>

          <t hangText="'description':">Includes a textual description of the
          SAP.</t>

          <t hangText="'attachment-interface':">Indicates a reference to the
          interface to which the SAP is bound. The same interface may host
          multiple services. <vspace blankLines="1" />Whether the attachment
          identifier echoes the content of the attachment interface is
          deployment specific. </t>

          <t hangText="'parent-termination-point':">Includes a reference to
          the parent interface to which the SAP is bound (e.g., a physical
          port). This attribute is used, e.g., to associate an interface with
          its sub-interfaces as all these interfaces may be listed under the
          SAPs of a node. It is also used to link a SAP with the physical
          topology.<vspace blankLines="1" />For example, this data node can be
          used to map the IETF Network Slice endpoints to the
          service/tunnel/path endpoints in the underlay network as per Section
          5.4 of <xref target="I-D.ietf-teas-ietf-network-slices"></xref>.</t>

          <t hangText="'interface-type':">Indicates whether a SAP is bound to
          a physical port, a loopback interface, a Link Aggregation Group
          (LAG) interface, an Integrated Routing Bridge (IRB), a local bridge
          reference, etc.</t>

          <t hangText="'encapsulation-type':">Indicates the encapsulation type
          for the interface indicated in the 'attachment-interface' attribute.
          The types are taken from <xref
          target="I-D.ietf-opsawg-vpn-common"></xref>. <vspace
          blankLines="1" />This data node can be used, for example, to decide
          whether an existing SAP to be used to host a service or if a new
          sub-interface has to be instantiated.</t>

          <t hangText="'interface-role':">Specifies whether a SAP is a UNI or
          NNI. <vspace blankLines="1" />A SAP inherits the role of its parent
          interface.</t>

          <t hangText="'peer-customer-sap-id':">Includes a reference to the
          remote endpoint of an attachment circuit.</t>

          <t hangText="'sap-status':">Indicates the status of a SAP. <vspace
          blankLines="1" />When both a sub-interface and its parent interface
          are present, the status of the parent interface takes precedence
          over the status indicated for the sub-interface.</t>

          <t hangText="'service-status':">Reports the service status for a
          given SAP. This information is particularly useful when many
          services are enabled for the same SAP, but only a subset of these
          services are activated.</t>
        </list></t>

      <t></t>
    </section>

    <section anchor="mod" title="SAP YANG Module">
      <t>This module imports types from <xref target="RFC8343"></xref>, <xref
      target="RFC8345"></xref>, and <xref
      target="I-D.ietf-opsawg-vpn-common"></xref>.</t>

      <figure>
        <artwork><![CDATA[<CODE BEGINS>  file "ietf-sap-ntw@2022-02-07.yang"
module ietf-sap-ntw {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-sap-ntw";
  prefix sap;

  import ietf-network-topology {
    prefix nt;
    reference
      "RFC 8345: A YANG Data Model for Network
                 Topologies, Section 6.2";
  }
  import ietf-network {
    prefix nw;
    reference
      "RFC 8345: A YANG Data Model for Network
                 Topologies, Section 6.1";
  }
  import ietf-vpn-common {
    prefix vpn-common;
    reference
      "RFC 9181: A Common YANG Data Model for Layer 2 and Layer 3
                 VPNs";
  }

  organization
    "IETF OPSA (Operations and Management Area) Working Group ";
  contact
    "WG Web:   <https://datatracker.ietf.org/wg/opsawg/>
     WG List:  <mailto:opsawg@ietf.org>

     Editor:   Mohamed Boucadair
               <mailto:mohamed.boucadair@orange.com>

     Author:   Oscar Gonzalez de Dios
               <mailto:oscar.gonzalezdedios@telefonica.com>

     Author:   Samier Barguil
               <mailto:samier.barguilgiraldo.ext@telefonica.com>

     Author:   Qin Wu
               <mailto:bill.wu@huawei.com>

     Author:   Victor Lopez
               <victor.lopez@nokia.com>";
  description
    "This YANG module defines a model for representing, managing,
     and controlling the Service Attachment Points (SAPs) in the
     network topology.

     Copyright (c) 2022 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject to
     the license terms contained in, the Revised BSD License set
     forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC XXXX
     (https://www.rfc-editor.org/info/rfcXXXX); see the RFC itself
     for full legal notices.";

  revision 2022-02-07 {
    description
      "Initial version";
    reference
      "RFC XXXX: A Network YANG Model for Service Attachment
                 Points (SAPs)";
  }

  identity service-type {
    description
      "Base identity for the service type.";
  }

  identity l3vpn {
    base service-type;
    description
      "L3VPN service.";
    reference
      "RFC 4364: BGP/MPLS IP Virtual Private Networks (VPNs)";
  }

  identity vpls {
    base service-type;
    description
      "Virtual Private LAN Service (VPLS).";
    reference
      "RFC 4761: Virtual Private LAN Service (VPLS) Using BGP for
                 Auto-Discovery and Signaling
       RFC 4762: Virtual Private LAN Service (VPLS) Using Label
                 Distribution Protocol (LDP) Signaling";
  }

  identity vpls-bgp {
    base service-type;
    description
      "VPLS using BGP.";
    reference
      "RFC 4761: Virtual Private LAN Service (VPLS) Using BGP for
                 Auto-Discovery and Signaling";
  }

  identity vpls-ldp {
    base service-type;
    description
      "VPLS using Label Distribution Protocol (LDP).";
    reference
      "RFC 4762: Virtual Private LAN Service (VPLS) Using Label
                 Distribution Protocol (LDP) Signaling";
  }

  identity vpws {
    base service-type;
    description
      "Virtual Private Wire Service (VPWS).";
    reference
      "RFC 4664: Framework for Layer 2 Virtual Private Networks
                 (L2VPNs), Section 3.1.1";
  }
  
  identity vpws-evpn {
    base service-type;
    description
      "EVPN used to support VPWS.";
    reference
      "RFC 8214: Virtual Private Wire Service Support in Ethernet VPN";
  }

  identity pbb-evpn {
    base service-type;
    description
      "Provider Backbone Bridging (PBB) EVPN service.";
    reference
      "RFC 7623: Provider Backbone Bridging Combined with Ethernet VPN
                 (PBB-EVPN)";
  }

  identity mpls-evpn {
    base service-type;
    description
      "MPLS-based EVPN service.";
    reference
      "RFC 7432: BGP MPLS-Based Ethernet VPN";
  }

  identity vxlan-evpn {
    base service-type;
    description
      "VXLAN-based EVPN service.";
    reference
      "RFC 8365: A Network Virtualization Overlay Solution Using
                 Ethernet VPN (EVPN)";
  }

  identity virtual-network {
    base service-type;
    description
      "Virtual network.";
    reference
      "RFC 8453: Framework for Abstraction and Control of TE
                 Networks (ACTN)";
  }

  identity enhanced-vpn {
    base service-type;
    description
      "Enhanced VPN (VPN+). VPN+ is an approach that is
       based on existing VPN and Traffic Engineering (TE) 
       technologies but adds characteristics that specific
       services require over and above traditional VPNs.";
    reference
      "I-D.ietf-teas-enhanced-vpn: 
         A Framework for Enhanced Virtual Private Network
         (VPN+) Services";
  }

  identity network-slice {
    base service-type;
    description
      "IETF network slice.  An IETF network slice
       is a logical network topology connecting a number of
       endpoints using a set of shared or dedicated network
       resources that are used to satisfy specific service
       objectives.";
    reference
      "I-D.ietf-teas-ietf-network-slices:
         Framework for IETF Network Slices";
  }

  identity sdwan {
    base service-type;
    description
      "PE-based Software-Defined Wide Area Network (SDWAN).";
    reference
      "I-D.ietf-bess-bgp-sdwan-usage: BGP Usage for SDWAN 
             Overlay Network";
  }

  identity basic-connectivty {
    base service-type;
    description
      "Basic IP connectivity.";
  }

  identity interface-role {
    description
      "Base identity for the network role of an interface.";
  }

  identity uni {
    base interface-role;
    description
      "User-Network Interface (UNI).";
  }

  identity nni {
    base interface-role;
    description
      "Network-to-Network Interface (NNI).";
  }

  identity interface-type {
    description
      "Base identity for the interface type.";
  }

  identity phy {
    base interface-type;
    description
      "Physical port.";
  }

  identity loopback {
    base interface-type;
    description
      "Loopback interface.";
  }

  identity lag {
    base interface-type;
    description
      "Link Aggregation Group (LAG) interface.";
  }

  identity irb {
    base interface-type;
    description
      "Integrated Routing Bridge (IRB).";
  }

  identity local-bridge {
    base interface-type;
    description
      "A local bridge reference to accommodate, e.g., 
       implementations that require internal bridging.
       When such a type is used, a reference to a local
       bridge domain is used to identify the interface.";
  }

  identity logical {
    base interface-type;
    description
      "Refers to a logical sub-interface that is typically 
       used to bind a service. This type is used only
       if none of the other logical types can be used.";
  }

  grouping sap-information {
    description
      "Service Attachment Point (SAP) information.";
    list service-attachment-point {
      key "attachment-id";
      description
        "The Service Attachment Points are abstraction of
         the points where network services such as L3VPNs,
         L2VPNs, or network slices can be attached to.";
      leaf attachment-id {
        type string;
        description
          "Indicates an identifier that uniquely identifies
           SAP within a node.";
      }
      leaf description {
        type string;
        description
          "A textual description of the SAP.";
      }
      leaf attachment-interface {
        type string;
        description
          "Indicates the interface to which the SAP is bound.";
      }
      leaf parent-termination-point {
        type nt:tp-id;
        description
          "Indicates the parent termination point to 
           which the SAP is attached to. A termination
           point can be a physical port, an interface, etc.";
      }
      leaf interface-type {
        type identityref {
          base interface-type;
        }
        description
          "The type of the interface to which the SAP is bound.";
      }
      leaf encapsulation-type {
        type identityref {
          base vpn-common:encapsulation-type;
        }
        description
          "Encapsulation type of the interface to which the 
           SAP is bound.";
      }
      leaf interface-role {
        type identityref {
          base interface-role;
        }
        description
          "Indicates whether the SAP is an UNI or a NNI.";
      }
      leaf peer-customer-sap-id {
        type string;
        description
          "Indicates an identifier of the peer's termination
           identifier (e.g., Customer Edge (CE)). This 
           information can be used for correlation purposes, 
           such as identifying the SAP that is attached to 
           an endpoint that is provided in a service request.";
      }      
      container sap-status {
        description
          "Indicates the SAP status.";
        config "false"; 
        uses vpn-common:oper-status-timestamp;
      }
      container service-status {
        description
          "Indicates the service status.";
        config "false"; 
        uses vpn-common:oper-status-timestamp;
      }
    }
  }

  augment "/nw:networks/nw:network/nw:network-types" {
    description
      "Introduces a new network type for SAP network.";
    container sap-network {
      presence "Indicates SAP Network Type.";
      description
        "The presence of the container node indicates the 
         SAP network type.";
      leaf-list sap-type {
        type identityref {
          base service-type;
        }
        description
          "Indicates the set of supported service types.";
      }
    }
  }

  augment "/nw:networks/nw:network/nw:node" {
    description
      "Parameters for the SAP level.";
    list service {
      key "sap-type";
      description
        "A list of supported service type for the node.";
      leaf sap-type {
        type identityref {
          base service-type;
        }
        description
          "Indicates a service type.";
      }
      uses sap-information;
   }
  }
}
<CODE ENDS>]]></artwork>
      </figure>
    </section>

    <section anchor="IANA" title="IANA Considerations">
      <t>This document registers the following namespace URI in the "ns"
      subregistry within the "IETF XML Registry" [RFC3688]: <figure>
          <artwork><![CDATA[    URI: urn:ietf:params:xml:ns:yang:ietf-sap-ntw
    Registrant Contact: The IESG.
    XML: N/A, the requested URI is an XML namespace.
]]></artwork>
        </figure></t>

      <t>This document registers the following YANG module in the YANG Module
      Names registry [RFC6020] within the "YANG Parameters" registry: <figure>
          <artwork><![CDATA[    name: ietf-sap-ntw
    namespace: urn:ietf:params:xml:ns:yang:ietf-sap-ntw
    maintained by IANA? N
    prefix: sap
    reference: RFC XXXX
]]></artwork>
        </figure></t>
    </section>

    <section anchor="scecurity" title="Security Considerations">
      <t>The YANG module specified in this document defines schema for data
      that is designed to be accessed via network management protocols such as
      NETCONF <xref target="RFC6241"></xref> or RESTCONF <xref
      target="RFC8040"></xref>. The lowest NETCONF layer is the secure
      transport layer, and the mandatory-to-implement secure transport is
      Secure Shell (SSH) <xref target="RFC6242"></xref>. The lowest RESTCONF
      layer is HTTPS, and the mandatory-to-implement secure transport is TLS
      <xref target="RFC8446"></xref>.</t>

      <t>The Network Configuration Access Control Model (NACM) <xref
      target="RFC8341"></xref> provides the means to restrict access for
      particular NETCONF or RESTCONF users to a preconfigured subset of all
      available NETCONF or RESTCONF protocol operations and content.</t>

      <t>There are a number of data nodes defined in this YANG module that are
      writable/creatable/deletable (i.e., config true, which is the default).
      These data nodes may be considered sensitive or vulnerable in some
      network environments. Write operations (e.g., edit-config) to these data
      nodes without proper protection can have a negative effect on network
      operations. These are the subtrees and data nodes and their
      sensitivity/vulnerability: <list style="symbols">
          <t>/nw:networks/nw:network/nw:node/sap:sap-type/sap:service-attachment-point<vspace
          blankLines="1" />This subtree specifies the configurations of the
          nodes in a SAP network model. Unexpected changes to this subtree
          (e.g., associating a SAP with another parent termination interface)
          could lead to service disruption and/or network misbehavior. </t>
        </list></t>

      <t>Some of the readable data nodes in this YANG module may be considered
      sensitive or vulnerable in some network environments. It is thus
      important to control read access (e.g., via get, get-config, or
      notification) to these data nodes. These are the subtrees and data nodes
      and their sensitivity/vulnerability:<list style="symbols">
          <t>/nw:networks/nw:network/nw:node/sap:sap-type/sap:service-attachment-point<vspace
          blankLines="1" />Unauthorized access to this subtree can disclose
          the operational state information of the nodes in a SAP network
          model (e.g., disclose the identity of a customer
          'peer-customer-sap-id').</t>
        </list></t>

      <t></t>
    </section>

    <section anchor="Acknowledgements" title="Acknowledgements">
      <t>Thanks to Adrian Farrell and Daniel King for the suggestions on the
      name used in a previous version.</t>

      <t>Thanks to Dhruv Dhody, Benoit Claise, Bo Wu, and Erez Segev for the
      comments.</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc include="reference.RFC.2119"?>

      <?rfc include="reference.RFC.3688"?>

      <?rfc include="reference.RFC.6020"?>

      <?rfc include="reference.RFC.6241"?>

      <?rfc include="reference.RFC.6242"?>

      <?rfc include="reference.RFC.7950"?>

      <?rfc include="reference.RFC.8040"?>

      <?rfc include="reference.RFC.8174"?>

      <?rfc include="reference.RFC.8341"?>

      <?rfc include="reference.RFC.8345"?>

      <?rfc include="reference.RFC.8346"?>

      <?rfc include="reference.RFC.8446"?>

      <?rfc include="reference.RFC.8795"?>

      <?rfc include='reference.I-D.ietf-opsawg-vpn-common'?>
    </references>

    <references title="Informative References">
      <?rfc include="reference.RFC.7149"?>

      <?rfc include="reference.RFC.7426"?>

      <?rfc include="reference.RFC.8299"?>

      <?rfc include='reference.RFC.8466'?>

      <?rfc include="reference.RFC.8309"?>

      <?rfc include="reference.RFC.8340"?>

      <?rfc include="reference.RFC.8342"?>

      <?rfc include="reference.RFC.8343"?>

      <?rfc include='reference.I-D.ietf-opsawg-l3sm-l3nm'?>

      <?rfc include='reference.I-D.ietf-opsawg-l2nm'?>

      <?rfc include='reference.RFC.8969'?>

      <?rfc include='reference.I-D.ietf-teas-ietf-network-slices'?>

      <?rfc include='reference.I-D.ietf-teas-enhanced-vpn'?>

      <?rfc include='reference.I-D.ietf-bess-bgp-sdwan-usage'?>

      <?rfc include='reference.RFC.4364'?>

      <?rfc include='reference.RFC.4761'?>

      <?rfc include='reference.RFC.4762'?>

      <?rfc include='reference.RFC.8214'?>

      <?rfc include='reference.RFC.7623'?>

      <?rfc include='reference.RFC.7432'?>

      <?rfc include='reference.RFC.8365'?>

      <?rfc include='reference.RFC.8453'?>
    </references>

    <section anchor="app1" title="A Simplified SAP Network Example">
      <t>An example of a SAP topology that is reported by a network controller
      is depicted in <xref target="ex1"></xref>. This example echoes the
      topology shown in <xref target="fi3a"></xref>. Only a minimum set of
      information is provided for each SAP.</t>

      <t><figure anchor="ex1" title="SAP Example">
          <artwork><![CDATA[{
  "ietf-network:networks": {
    "network": [
      {
        "network-types": {
          "sap-type": [
            "l3vpn",
            "vpls"
          ]
        },
        "network-id": "an-id",
        "node": [
          {
            "node-id": "PE1",
            "ietf-sap-ntw:service": [
              {
                "sap-type": "l3vpn",
                "service-attachment-point": [
                  {
                    "attachment-id": "sap#11",
                    "peer-customer-sap-id": "ce-1",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  },
                  {
                    "attachment-id": "sap#12"
                  },
                  {
                    "attachment-id": "sap#13"
                  },
                  {
                    "attachment-id": "sap#14"
                  }
                ]
              }
            ]
          },
          {
            "node-id": "PE2",
            "ietf-sap-ntw:service": [
              {
                "sap-type": "l3vpn",
                "service-attachment-point": [
                  {
                    "attachment-id": "sap#21"
                  },
                  {
                    "attachment-id": "sap#22",
                    "peer-customer-sap-id": "ce-2",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  }
                ]
              }
            ]
          },
          {
            "node-id": "PE3",
            "ietf-sap-ntw:service": [
              {
                "sap-type": "l3vpn",
                "service-attachment-point": [
                  {
                    "attachment-id": "sap#31"
                  },
                  {
                    "attachment-id": "sap#32"
                  },
                  {
                    "attachment-id": "sap#33",
                    "peer-customer-sap-id": "ce-3",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  }
                ]
              }
            ]
          },
          {
            "node-id": "PE4",
            "ietf-sap-ntw:service": [
              {
                "sap-type": "l3vpn",
                "service-attachment-point": [
                  {
                    "attachment-id": "sap#41"
                  },
                  {
                    "attachment-id": "sap#42",
                    "peer-customer-sap-id": "ce-4",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  },
                  {
                    "attachment-id": "sap#43"
                  },
                  {
                    "attachment-id": "sap#44",
                    "peer-customer-sap-id": "ce-5",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}]]></artwork>
        </figure></t>

      <t></t>
    </section>

    <section anchor="sample"
             title="A Simple Example of SAP Network Model: Node Filter">
      <t>In the example shown in <xref target="app-ex"></xref>, PE1 has two
      physical interfaces "GE0/6/1" and "GE0/6/4". Two sub-interfaces
      "GE0/6/4.1" and "GE0/6/4.2" are associated with the physical interface
      "GE0/6/4". Let us consider that four SAPs are exposed to the service
      orchestrator and mapped to these physical interfaces and
      sub-interfaces.</t>

      <t><figure align="center" anchor="app-ex"
          title="An Example of PE and Associated Physical Interfaces">
          <artwork><![CDATA[   .-------------------------.
   |                 GE0/6/4 |
   | PE1                .----+----.
   |                    |sap#2    |GE0/6/4.1
   |                    |      .--+--.
   |                    |      |sap#3|
   |                    |      '--+--'
   |                    |         |GE0/6/4.2
   |                    |      .--+--.
   |                    |      |sap#4|
   |                    |      '--+--'
   |                    |         |
   |                    +----+----+
   |                         |
   |                  GE0/6/1|
   |                    .----+----.
   |                    |sap#1    |
   |                    '----+----'
   |                         |
   '-------------------------'
]]></artwork>
        </figure></t>

      <t>Let us assume that no servie is enabled yet for the SAP associated
      with the physical interface "GE0/6/1". Also, let us assume that, for the
      SAPs that are associated with the physical interface "GE0/6/4", VPLS and
      L3VPN services are activated on the two sub-interfaces "GE0/6/4.1" and
      "GE0/6/4.2", respectively.</t>

      <t>A service orchestrator can query what services are provided on which
      SAPs of PE1 from the network controller by sending, e.g., a GET RESTCONF
      request. <xref target="app-ex-res-body"></xref> shows the body of the
      RESTCONF response that is received from the network controller.</t>

      <t><figure anchor="app-ex-res-body"
          title="Example of a Response Body to a Request with a Node Filter">
          <artwork><![CDATA[{
  "ietf-sap-ntw:service": [
    {
      "sap-type": "l3vpn",
      "service-attachment-point": [
        {
          "attachment-id": "sap#1",
          "description": "Ready to host SAPs",
          "attachment-interface": "GE0/6/1",
          "interface-type": "ietf-sap-ntw:phy",
          "interface-role": "ietf-sap-ntw:uni",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          }
        },
        {
          "attachment-id": "sap#2",
          "description": "Ready to host SAPs",
          "attachment-interface": "GE0/6/4",
          "interface-type": "ietf-sap-ntw:phy",
          "interface-role": "ietf-sap-ntw:uni",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          }
        },
        {
          "attachment-id": "sap#3",
          "description": "A first SAP description",
          "attachment-interface": "GE0/6/4.1",
          "interface-type": "ietf-sap-ntw:logical",
          "parent-termination-point": "GE0/6/4",
          "encapsulation-type": "ietf-vpn-common:vlan-type",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          },
          "service-status": {
            "status": "ietf-vpn-common:op-up"
          }
        }
      ]
    },
    {
      "sap-type": "vpls",
      "service-attachment-point": [
          "attachment-id": "sap#1",
          "description": "Ready to host SAPs",
          "attachment-interface": "GE0/6/1",
          "interface-type": "ietf-sap-ntw:phy",
          "interface-role": "ietf-sap-ntw:uni",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          }
        },
        {
          "attachment-id": "sap#2",
          "description": "Ready to host SAPs",
          "attachment-interface": "GE0/6/4",
          "interface-type": "ietf-sap-ntw:phy",
          "interface-role": "ietf-sap-ntw:uni",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          }
        },
        {
          "attachment-id": "sap#4",
          "description": "Another description",
          "attachment-interface": "GE0/6/4.2",
          "interface-type": "ietf-sap-ntw:logical",
          "parent-termination-point": "GE0/6/4",
          "encapsulation-type": "ietf-vpn-common:vlan-type",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          },
          "service-status": {
            "status": "ietf-vpn-common:op-up"
          }
        }
      ]
    }
  ]
}
]]></artwork>
        </figure></t>

      <t><xref target="app-ex-res-body-filter"></xref> shows the message body
      of a response that is received from the network controller if the
      request includes a filter on the service type for a particular node:</t>

      <t><figure anchor="app-ex-res-body-filter"
          title="Example of a Response Body to a Request with a Service Filter">
          <artwork><![CDATA[{
  "ietf-sap-ntw:service": [
    {
      "sap-type": "l3vpn",
      "service-attachment-point": [
        {
          "attachment-id": "sap#1",
          "description": "Ready to host SAPs",
          "attachment-interface": "GE0/6/1",
          "interface-type": "ietf-sap-ntw:phy",
          "interface-role": "ietf-sap-ntw:uni",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          }
        },
        {
          "attachment-id": "sap#2",
          "description": "Ready to host SAPs",
          "attachment-interface": "GE0/6/4",
          "interface-type": "ietf-sap-ntw:phy",
          "interface-role": "ietf-sap-ntw:uni",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          }
        },
        {
          "attachment-id": "sap#3",
          "description": "A first SAP description",
          "attachment-interface": "GE0/6/4.1",
          "interface-type": "ietf-sap-ntw:logical",
          "parent-termination-point": "GE0/6/4",
          "encapsulation-type": "ietf-vpn-common:vlan-type",
          "sap-status": {
            "status": "ietf-vpn-common:op-up"
          },
          "service-status": {
            "status": "ietf-vpn-common:op-up"
          }
        }
      ]
    }
  ]
}
]]></artwork>
        </figure></t>

      <t></t>
    </section>

    <section anchor="nniapp" title="An NNI SAP Example: Inter-AS VPN Option A">
      <t>Section 10 of <xref target="RFC4364"></xref> discuses several option
      to extend the scope of a VPN service beyond the scope of a single
      Autonomous System (AS). For illustration purposes, this section focuses
      on the so called "option a" but similar examples can be considered for
      other options. </t>

      <t>In option a, a PE in an AS attaches directly to a PE in the peer AS.
      These two PEs are attached by multiple sub-interfaces, at least one for
      each of the VPNs whose routes need to be passed from AS to AS. Each PE
      treats the other as if it were a CE. </t>

      <t><xref target="optiona"></xref> shows a simplified (excerpt) topology
      of two ASes with a focus on the interconnection links between these two
      ASes.</t>

      <t><figure anchor="optiona">
          <artwork><![CDATA[.--------------------.                      .--------------------.
|                    |                      |                    |
|                 .--+--.                .--+--.                 |
|              A  |     +================+     |  A              |
|              S  | (VRF1)----(VPN1)----(VRF1) |  S              |
|              B  |     |                |     |  B              |
|              R  | (VRF2)----(VPN2)----(VRF2) |  R              |
|              1  |     +================+     |  1              |
|                 '--+--'                '--+--'                 |
|     AS A           |                      |         AS B       |
|                 .--+--.                .--+--.                 |
|              A  |     +================+     |  A              |
|              S  | (VRF1)----(VPN1)----(VRF1) |  S              |
|              B  |     |                |     |  B              |
|              R  | (VRF2)----(VPN2)----(VRF2) |  R              |
|              2  |     +================+     |  2              |
|                 '--+--'                '--+--'                 |
|                    |                      |                    |
'--------------------'                      '--------------------']]></artwork>
        </figure></t>

      <t><xref target="nniex1"></xref> shows an example of a message body that
      is received from the network controller of AS A (with a focus on the
      NNIs shown in <xref target="optiona"></xref>). Note that only a subset
      of the SAP-related data is included in the example. </t>

      <t><figure anchor="nniex1" title="SAP for NNI Usage">
          <artwork><![CDATA[{
  "ietf-network:networks": {
    "network": [
      {
        "network-types": {
          "sap-type": [
            "l3vpn"
          ]
        },
        "network-id": "an-id",
        "node": [
          {
            "node-id": "asbr1",
            "ietf-sap-ntw:service": [
              {
                "sap-type": "l3vpn",
                "service-attachment-point": [
                  {
                    "attachment-id": "sap#11",
                    "description": "parent inter-as link#1",
                    "interface-role": "nni",
                    "peer-customer-sap-id": "asbr-b-1",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  },
                  {
                    "attachment-id": "sap#12",
                    "description": "parent inter-as link#2",
                    "interface-role": "nni",
                    "peer-customer-sap-id": "asbr-b-1",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  },
                  {
                    "attachment-id": "sap#13",
                    "description": "vpn1",
                    "interface-role": "nni",
                    "peer-customer-sap-id": "asbr-b-1",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  },
                  {
                    "attachment-id": "sap#14",
                    "description": "vpn2",
                    "interface-role": "nni",
                    "peer-customer-sap-id": "asbr-b-1",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  }
                ]
              }
            ]
          },
          {
            "node-id": "asbra2",
            "ietf-sap-ntw:service": [
              {
                "sap-type": "l3vpn",
                "service-attachment-point": [
                  {
                    "attachment-id": "sap#11",
                    "description": "parent inter-as link#1",
                    "interface-role": "nni",
                    "peer-customer-sap-id": "asbr-b-2",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  },
                  {
                    "attachment-id": "sap#12",
                    "description": "parent inter-as link#2",
                    "interface-role": "nni",
                    "peer-customer-sap-id": "asbr-b-2",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  },
                  {
                    "attachment-id": "sap#21",
                    "description": "vpn1",
                    "interface-role": "nni",
                    "peer-customer-sap-id": "asbr-b-2",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  },
                  {
                    "attachment-id": "sap#22",
                    "description": "vpn2",
                    "interface-role": "nni",
                    "peer-customer-sap-id": "asbr-b-2",
                    "service-status": {
                      "status": "ietf-vpn-common:op-up"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}]]></artwork>
        </figure></t>

      <t></t>
    </section>
  </back>
</rfc>
